generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mongodb"
    url      = env("DATABASE_URL")
}

model User {
    id        String    @id @default(auto()) @map("_id") @db.ObjectId
    user      String    @unique
    password  String
    fullname  String
    createdAt DateTime  @default(now())
    lastLogin String?
    roles     String[]  @default(["staff"])
    token     String?   @unique
    mail      Mail      @unique
    resigned  Resigned?
    avatar    Avatar?
    otp       OTP?
}

model Patient {
    id             String         @id @default(auto()) @map("_id") @db.ObjectId
    card_no        String         @unique
    fullname       String
    age            Int
    sex            Sex
    date           String         @default("")
    phone_no       String?
    address        String?
    death          Death?
    body           Body[]
    recommendation Recommendation
}

enum Sex {
    Male
    Female
}

type Mail {
    email    String?
    verified Boolean @default(false)
}

type Resigned {
    date   String?
    resign Boolean? @default(false)
}

type Avatar {
    secure_url String
    public_id  String
}

type OTP {
    totp     String
    totpDate Int
}

type Death {
    date String?
    dead Boolean @default(false)
}

type Body {
    idx       String
    date      String
    next_app  String?
    diagnosis Diagnosis
}

type Diagnosis {
    texts  String?
    images Images[]
}

type Images {
    secure_url String?
    public_id  String?
}

type Recommendation {
    extensions    Extensions[]
    opthalmology  Opthalmology
    physiotherapy Physiotherapy
}

type Medication {
    idx      String
    date     String
    next_app String?
}

type Opthalmology {
    eligible   Boolean?
    medication Medication[]
}

type Physiotherapy {
    eligible   Boolean?
    medication Medication[]
}

type Extensions {
    idx       String
    date      String
    name      String
    given     Boolean?
    occurence Int?
}
